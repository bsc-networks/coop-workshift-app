<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.js"></script>

<!-- Latest compiled and minified Locales -->
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/locale/bootstrap-table-zh-CN.min.js"></script>

<h4>Recent Online Signoffs</h4>
<div>If you think one of these signoffs is inaccurate, click on the member name to send an email to the workshift manager.</div>
<div class="hline"></div>
<table data-toggle="table" class="table table-striped table-hover" id="signed-off-shifts">
  <thead>
    <tr>
      <th data-sortable="true" data-sorter="dateSorter">Date of Workshift</th>
      <th data-sortable="true">Workshift</th>
      <th data-sortable="true">Member</th>
      <th data-sortable="true">Hours</th>
      <th data-sortable="true">Verifier</th>
      <th data-sortable="true">Time Signed Off</th>
    </tr>
  </thead>
  <tbody>
    <% @signed_off_shifts.each do |shift| %>
      <tr>
        <td><%= shift.get_date %></td>
        <td><%= shift.get_name %></td>
        <td><%= link_to "#{shift.user.full_name}", email_admin_path(shift.id) %></td>
        <td><%= shift.workshift.length %></td>
        <td><%= shift.signoff_by.full_name %></td>
        <td><%= shift.get_signoff_datetime %></td>
      </tr>
    <% end %>
  </tbody>
</table>






<script>
  var EmailPopup = {
    setup: function() {
      var popupDiv = $('<div id="emailForm"></div>');
      popupDiv.hide().appendTo($('body'));
      $(document).on('click', '#signed-off-shifts a', EmailPopup.getEmailForm);
    }
    ,getEmailForm: function() {
      $.ajax({type: 'GET',
              url: $(this).attr('href'),
              timeout: 5000,
              success: EmailPopup.showEmailForm,
              error: function(xhrObj, textStatus, exception) { alert('Error!'); }
             });
      return(false);
    }
    ,showEmailForm: function(data, requestStatus, xhrObject) {
      var oneFourth = Math.ceil($(window).width() / 4);
      $('#emailForm').
        css({'left': oneFourth,  'width': 2*oneFourth, 'top': 250}).
        html(data).
        show();
      // $('#closeLink').click(EmailPopup.hideEmailForm);
      return(false);
    }
    ,hideEmailForm: function() {
      $('#emailForm').hide();
      return(false);
    }
  };
  $(EmailPopup.setup);
  
</script>
